!function(e){function t(t){for(var a,l,r=t[0],i=t[1],u=t[2],f=0,c=[];f<r.length;f++)l=r[f],Object.prototype.hasOwnProperty.call(s,l)&&s[l]&&c.push(s[l][0]),s[l]=0;for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(e[a]=i[a]);for(d&&d(t);c.length;)c.shift()();return o.push.apply(o,u||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],a=!0,r=1;r<n.length;r++){var i=n[r];0!==s[i]&&(a=!1)}a&&(o.splice(t--,1),e=l(l.s=n[0]))}return e}var a={},s={18:0},o=[];function l(t){if(a[t])return a[t].exports;var n=a[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,l),n.l=!0,n.exports}l.e=function(e){var t=[],n=s[e];if(0!==n)if(n)t.push(n[2]);else{var a=new Promise((function(t,a){n=s[e]=[t,a]}));t.push(n[2]=a);var o,r=document.createElement("script");r.charset="utf-8",r.timeout=120,l.nc&&r.setAttribute("nonce",l.nc),r.src=function(e){return l.p+""+({}[e]||e)+".js"}(e);var i=new Error;o=function(t){r.onerror=r.onload=null,clearTimeout(u);var n=s[e];if(0!==n){if(n){var a=t&&("load"===t.type?"missing":t.type),o=t&&t.target&&t.target.src;i.message="Loading chunk "+e+" failed.\n("+a+": "+o+")",i.name="ChunkLoadError",i.type=a,i.request=o,n[1](i)}s[e]=void 0}};var u=setTimeout((function(){o({type:"timeout",target:r})}),12e4);r.onerror=r.onload=o,document.head.appendChild(r)}return Promise.all(t)},l.m=e,l.c=a,l.d=function(e,t,n){l.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},l.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},l.t=function(e,t){if(1&t&&(e=l(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(l.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)l.d(n,a,function(t){return e[t]}.bind(null,a));return n},l.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return l.d(t,"a",t),t},l.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},l.p="",l.oe=function(e){throw console.error(e),e};var r=window.webpackJsonp=window.webpackJsonp||[],i=r.push.bind(r);r.push=t,r=r.slice();for(var u=0;u<r.length;u++)t(r[u]);var d=i;o.push([1973,0]),n()}({1973:function(e,t,n){n.p=function(){function e(e,t){if(window.$C&&window.$C.hasOwnProperty(e))return window.$C[e];if(void 0!==t)return t;throw new Error("getConfigValue - "+e+" not set, no default provided")}return function(){for(var t,n,a="",s=0,o=arguments.length;s<o;s++)(n=(t=arguments[s].toString()).length)>1&&"/"==t.charAt(n-1)&&(t=t.substring(0,n-1)),"/"!=t.charAt(0)?a+="/"+t:a+=t;if("/"!=a){var l=a.split("/"),r=l[1];if("static"==r||"modules"==r){var i=a.substring(r.length+2,a.length);a="/"+r,window.$C.BUILD_NUMBER&&(a+="/@"+window.$C.BUILD_NUMBER),window.$C.BUILD_PUSH_NUMBER&&(a+="."+window.$C.BUILD_PUSH_NUMBER),"app"==l[2]&&(a+=":"+e("APP_BUILD",0)),a+="/"+i}}var u=e("MRSPARKLE_ROOT_PATH","/"),d=e("LOCALE","en-US"),f="/"+d+a;return""==u||"/"==u?f:u+f}("/static/build/pages/enterprise")+"/"}(),n(1);var a=o(n("routers/Tokens")),s=o(n("util/router_utils"));function o(e){return e&&e.__esModule?e:{default:e}}new a.default,s.default.start_backbone_history()},1976:function(e,t,n){(e.exports=n(3)(!1)).push([e.i,"button[data-test-name=action-link]>div{text-overflow:ellipsis;overflow:hidden}",""])},"routers/Tokens":function(e,t,n){"use strict";(function(a){n(1),Object.defineProperty(t,"__esModule",{value:!0});var s=C(n(10)),o=C(n(11)),l=C(n(13)),r=C(n(15)),i=C(n(16)),u=C(n(0)),d=C(n("shim/jquery")),f=n(7),c=C(n("routers/Base")),p=n(26),h=n(34),g=C(n("views/tokens/Tokens")),m=C(n(47)),k=C(n(136)),b=C(n(35)),T=n("views/tokens/Utils"),_=C(n("util/react_render")),E=C(n("uri/route")),v=n(150);function C(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(){var e,n,l,i;(0,o.default)(this,t);for(var d=arguments.length,c=Array(d),g=0;g<d;g++)c[g]=arguments[g];return n=l=(0,r.default)(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),l.getTokenAuth=function(){return a((0,T.getTokenAuthSettingsURL)(),(0,s.default)({},h.defaultFetchInit)).then((0,h.handleResponse)(200)).then((function(e){return l.tokenAuth=e,l.deferreds.tokenAuth.resolve(),e})).catch((0,h.handleError)((0,f._)("Unable to fetch token authentication settings.")))},l.callToggleTokenAuth=function(e){return a(e,(0,s.default)({},h.defaultFetchInit,{method:"POST"})).then((0,h.handleResponse)(200)).catch((0,h.handleError)((0,f._)("Unable to change token status.")))},l.callCreateToken=function(e){return a((0,p.createRESTURL)(T.TOKENS_COLLECTION_PATH),(0,s.default)({},h.defaultFetchInit,{method:"POST",body:b.default.encode(e)})).then((0,h.handleResponse)(201)).catch((0,h.handleError)((0,f._)("Unable to create token.")))},l.callDeleteToken=function(e){return a(e,(0,s.default)({},h.defaultFetchInit,{method:"DELETE"})).then((0,h.handleResponse)(200)).catch((0,h.handleError)((0,f._)("Unable to delete token.")))},l.callChangeStatus=function(e){return a(e,(0,s.default)({},h.defaultFetchInit,{method:"POST"})).then((0,h.handleResponse)(200)).catch((0,h.handleError)((0,f._)("Unable to change token status.")))},l.getExpansionRow=function(e,t){return u.default.createElement(m.default.Row,{key:"expansion-row-"+e.name},u.default.createElement(m.default.Cell,{key:"expansion-cell-"+e.name,style:{borderTop:"none"},colSpan:t},u.default.createElement(k.default,null,u.default.createElement(k.default.Term,null,(0,f._)("Token ID")),u.default.createElement(k.default.Description,null,e.name),u.default.createElement(k.default.Term,null,(0,f._)("Issued By")),u.default.createElement(k.default.Description,null,e.content.claims.iss),u.default.createElement(k.default.Term,null,(0,f._)("Not Before")),u.default.createElement(k.default.Description,null,(0,T.formatTimestamp)(e.content.claims.nbr)),u.default.createElement(k.default.Term,null,(0,f._)("Identity Provider")),u.default.createElement(k.default.Description,null,e.content.claims.idp),u.default.createElement(k.default.Term,null,(0,f._)("Last Used IP")),u.default.createElement(k.default.Description,null,(0,T.formatLastUsedIp)(e.content.lastUsedIp)))))},l.getProps=function(e){var t=e.user.entry.content.get("capabilities"),n=(0,T.getTokenPermissions)(t);return{objectsCollectionPath:T.TOKENS_COLLECTION_PATH,username:e.user.entry.get("name"),getTokenAuth:l.getTokenAuth,callCreateToken:l.callCreateToken,callDeleteToken:l.callDeleteToken,callChangeStatus:l.callChangeStatus,callToggleTokenAuth:l.callToggleTokenAuth,getExpansionRow:l.getExpansionRow,formatStatus:l.formatStatus,getEditUrl:function(){return null},isEnabled:function(e){return"enabled"===e.content.status},showStatusColumn:!0,showActionsColumn:t.indexOf("edit_tokens_all")>-1||t.indexOf("edit_tokens_own")>-1,tokenAuthEnabled:l.tokenAuth.entry&&l.tokenAuth.entry[0]&&!(0,v.normalizeBoolean)(l.tokenAuth.entry[0].content.disabled),defaultExpiration:l.tokenAuth.entry&&l.tokenAuth.entry[0]&&l.tokenAuth.entry[0].content.expiration,learnMoreLink:E.default.docHelp(l.model.application.get("root"),l.model.application.get("localed"),"learnmore.security.tokenauth"),canViewTokens:(0,T.canViewTokens)(n),permissions:n}},i=n,(0,r.default)(l,i)}return(0,i.default)(t,e),(0,l.default)(t,[{key:"initialize",value:function(){for(var e,t=arguments.length,n=Array(t),a=0;a<t;a++)n[a]=arguments[a];(e=c.default.prototype.initialize).call.apply(e,[this].concat(n)),this.enableAppBar=!1,this.setPageTitle((0,f._)("Tokens")),this.deferreds.tokenAuth=d.default.Deferred()}},{key:"page",value:function(){var e,t=this;this.getTokenAuth();for(var n=arguments.length,a=Array(n),s=0;s<n;s++)a[s]=arguments[s];(e=c.default.prototype.page).call.apply(e,[this].concat(a)),d.default.when(this.deferreds.pageViewRendered,this.deferreds.user,this.deferreds.serverInfo,this.deferreds.tokenAuth).done((function(){(0,d.default)(".preload").replaceWith(t.pageView.el);var e=t.getProps(t.model);(0,_.default)(u.default.createElement(g.default,e),(0,d.default)(".main-section-body")[0])}))}}]),t}(c.default);t.default=y,e.exports=t.default}).call(this,n(31))},"views/tokens/Tokens":function(e,t,n){"use strict";n(1),Object.defineProperty(t,"__esModule",{value:!0});var a=C(n(10)),s=C(n(11)),o=C(n(13)),l=C(n(15)),r=C(n(16)),i=n(0),u=C(i),d=n(7),f=C(n(14)),c=C(n(38)),p=C(n(20)),h=C(n(29)),g=C(n(22)),m=C(n(2)),k=C(n("views/tokens/table/columns/TokenActions")),b=C(n("views/tokens/modals/CreateToken")),T=n("views/tokens/Utils");n("views/tokens/Tokens.pcss");var _=C(n("views/tokens/TokensDisabled")),E=C(n("views/tokens/modals/TokenSettings")),v=C(n("views/tokens/TokensMain"));function C(e){return e&&e.__esModule?e:{default:e}}var y=function(e){function t(e,n){(0,s.default)(this,t);var a=(0,l.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.setTokenSettings=function(e,t){a.setState({isWorking:!1,tokenAuthEnabled:!e,defaultExpiration:t})},a.setWarning=function(e){a.setState({warning:e})},a.handleToggleTokenAuth=function(){a.setState({isWorking:!0}),a.props.callToggleTokenAuth((0,T.getToggleTokenAuthURL)(a.state.tokenAuthEnabled)).then((function(){a.setState((function(e){return{isWorking:!1,disableTokenAuthOpen:!1,errorMessage:"",tokenAuthEnabled:!e.tokenAuthEnabled}}))}),(function(e){return a.setState({isWorking:!1,errorMessage:e.message})}))},a.openTokenSettingsModal=function(){a.setState({tokenSettingsModalOpen:!0})},a.handleTokenSettingsModalClose=function(){a.setState({isWorking:!1,tokenSettingsModalOpen:!1,errorMessage:""})},a.checkTokenAuth=function(){a.props.getTokenAuth().then((function(e){var t=e.entry[0].content.disabled;a.setState({tokenAuthEnabled:!t})}))},a.state={tokenSettingsModalOpen:!1,isWorking:!1,tokenAuthEnabled:a.props.tokenAuthEnabled,defaultExpiration:a.props.defaultExpiration},a}return(0,r.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){return this.state.tokenAuthEnabled?u.default.createElement("div",{"data-test-name":"TokensManagerPage"},this.state.warning&&u.default.createElement(p.default,{type:"warning"},this.state.warning),this.props.permissions.editSettings&&u.default.createElement("div",null,u.default.createElement(f.default,{style:this.props.canViewTokens?{float:"right",top:"20px",margin:"0 20px 0 10px"}:{margin:"0 20px 0 20px",position:"absolute",top:"155px"},label:(0,d._)("Token Settings"),onClick:this.openTokenSettingsModal,"data-test-name":"TokenSettingsBtn"}),this.state.tokenSettingsModalOpen&&u.default.createElement(E.default,{objectNameSingular:this.props.objectNameSingular,open:this.state.tokenSettingsModalOpen,handleRequestClose:this.handleTokenSettingsModalClose,setTokenSettings:this.setTokenSettings,tokenAuthEnabled:this.state.tokenAuthEnabled,defaultExpiration:this.state.defaultExpiration,callToggleTokenAuth:this.props.callToggleTokenAuth})),this.props.canViewTokens?u.default.createElement(v.default,(0,a.default)({setWarning:this.setWarning,checkTokenAuth:this.checkTokenAuth},this.props)):u.default.createElement("div",{style:{padding:"20px 20px 0",maxWidth:"600px",display:"block"},"data-test-name":"TokensManagerPage.editTokensSettingsOnly"},u.default.createElement(c.default,{level:1,style:{margin:"0 0 10px 0",lineHeight:"24px"},"data-test-name":"TokensManagerPage.Heading"},(0,d._)("Token authentication is currently enabled")),u.default.createElement(h.default,{"data-test-name":"TokensManagerPage.Paragraph"},(0,d._)('You don\'t have permission to manage individual tokens on this instance, but there might be enabled tokens. If you click "Disable Token Authentication", all currently enabled tokens are disabled. If you need to manage individual tokens, contact your administrator. '),u.default.createElement(g.default,{to:this.props.learnMoreLink,"data-test-name":"TokensManagerPage.learnMoreLink",openInNewContext:!0},(0,d._)("Learn More"))))):u.default.createElement(_.default,(0,a.default)({handleToggleTokenAuth:this.handleToggleTokenAuth},this.props))}}]),t}(i.Component);y.propTypes={callToggleTokenAuth:m.default.func.isRequired,getTokenAuth:m.default.func.isRequired,tokenAuthEnabled:m.default.bool.isRequired,defaultExpiration:m.default.string,learnMoreLink:m.default.string.isRequired,canViewTokens:m.default.bool.isRequired,objectNameSingular:m.default.string,permissions:m.default.shape({editSettings:m.default.bool.isRequired}).isRequired},y.defaultProps={showAppColumn:!1,showOwnerColumn:!1,showAppFilter:!1,showOwnerFilter:!1,showSharingColumn:!1,hasRowExpansion:!0,objectNamePlural:(0,d._)("Tokens"),objectNameSingular:(0,d._)("Token"),ColumnActions:k.default,ModalNew:b.default,customColumns:[{key:"usernameCol",sortKey:"claims.sub",label:(0,d._)("Username"),content:function(e){return e.content.claims.sub}},{key:"audienceCol",sortKey:"claims.aud",label:(0,d._)("Audience"),content:function(e){return e.content.claims.aud}},{key:"issuedAtCol",sortKey:"claims.iat",label:(0,d._)("Issued At"),content:function(e){return(0,T.formatTimestamp)(e.content.claims.iat)}},{key:"expirationCol",sortKey:"claims.exp",label:(0,d._)("Expiration"),content:function(e){return(0,T.formatTokenExp)(e.content.claims.exp)}},{key:"lastUsed",sortKey:"lastUsed",label:(0,d._)("Last Used"),content:function(e){return(0,T.formatLastUsedTime)(e.content.lastUsed)}}],defaultExpiration:"",getObjectsCollectionFetchData:function(e,t){var n={count:e.countPerPage,sort_key:e.sortKey,sort_dir:e.sortDirection,offset:e.offset,search:e.filterString?e.filterString.substring(0,T.MAX_FILTER_LENGTH):null,output_mode:"json"};this.permissions.listAll||this.permissions.editAll||(n.username=this.username);var a=Object.assign({},n,t);return delete a.filterString,a}},t.default=y,e.exports=t.default},"views/tokens/Tokens.pcss":function(e,t,n){var a=n(1976);"string"==typeof a&&(a=[[e.i,a,""]]);var s={sourceMap:!1,hmr:!0,transform:void 0,insertInto:void 0};n(4)(a,s);a.locals&&(e.exports=a.locals)},"views/tokens/TokensDisabled":function(e,t,n){"use strict";n(1),Object.defineProperty(t,"__esModule",{value:!0});var a=d(n(0)),s=d(n(2)),o=d(n(38)),l=d(n(14)),r=d(n(29)),i=d(n(22)),u=n(7);function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){return a.default.createElement("div",{style:{padding:"20px 20px 0"},"data-test-name":"TokensDisabledPage"},a.default.createElement(o.default,{level:1,style:{margin:"0 0 10px 0"},"data-test-name":"TokensDisabledPage.heading"},(0,u._)("Token authentication is currently disabled")),a.default.createElement("div",null,a.default.createElement(r.default,{"data-test-name":"TokensDisabledPage.paragraph"},e.permissions.editSettings?(0,u._)('Click "Enable Token Authentication" to enable token authentication. '):(0,u._)("You don't have permission to make changes to token authentication settings. Contact your administrator and have them assign you a role that has this capability. "),a.default.createElement(i.default,{to:e.learnMoreLink,openInNewContext:!0,"data-test-name":"TokensDisabledPage.learnMoreLink"},(0,u._)("Learn More"))),e.permissions.editSettings&&a.default.createElement(l.default,{label:(0,u._)("Enable Token Authentication"),appearance:"primary",onClick:e.handleToggleTokenAuth,"data-test-name":"TokensDisabledPage.enableBtn"})))};f.propTypes={handleToggleTokenAuth:s.default.func.isRequired,learnMoreLink:s.default.string.isRequired,permissions:s.default.shape({editSettings:s.default.bool.isRequired}).isRequired},t.default=f,e.exports=t.default},"views/tokens/TokensMain":function(e,t,n){"use strict";(function(a){n(1),Object.defineProperty(t,"__esModule",{value:!0});var s=g(n(10)),o=g(n(11)),l=g(n(15)),r=g(n(16)),i=g(n(512)),u=n(34),d=n(7),f=n(28),c=n(12),p=g(n(35)),h=g(n(2));function g(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(){var e,n,s,r;(0,o.default)(this,t);for(var i=arguments.length,h=Array(i),g=0;g<i;g++)h[g]=arguments[g];return n=s=(0,l.default)(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(h))),s.handleRefreshListing=function(e){s.props.checkTokenAuth(),s.setState({fetchingCollection:!0,fetchingCount:!0,selectedRows:[],errorMessage:""}),s.handleRefreshListingInternal(e)},s.handleRefreshListingInternal=(0,c.debounce)((function(e){var t=s.props.getObjectsCollectionFetchData(s.state,e);"function"==typeof s.fetchCount&&s.fetchCount(e);var n=""+s.props.objectsCollectionPath;a(n+"?"+p.default.stringify(t),u.defaultFetchInit).then((0,u.handleResponse)(200)).then((function(e){var t={objects:e.entry?e.entry:e,fetchingCollection:!1};if(e.paging&&(t.objectsCount=e.paging.total,t.fetchingCount=!1),e.messages)for(var n=0;n<e.messages.length;n+=1)if(e.messages[n].text.includes("Unable to fill user info for tokenId")){s.props.setWarning((0,d._)("Unable to supply user information for some tokens. Failed to retrieve one or more external users from any configured servers. Review splunkd.log for details."));break}s.setState(t)})).catch((0,u.handleError)((0,f.sprintf)((0,d._)("Fetch %s collection failed."),s.props.objectNamePlural.toLowerCase()))).catch((function(e){s.setState({errorModalOpen:!0,errorMessage:e.message})}))}),500),r=n,(0,l.default)(s,r)}return(0,r.default)(t,e),t}(i.default);m.propTypes=(0,s.default)({},i.default.propTypes,{checkTokenAuth:h.default.func.isRequired,setWarning:h.default.func.isRequired}),t.default=m,e.exports=t.default}).call(this,n(31))},"views/tokens/Utils":function(e,t,n){"use strict";n(1),Object.defineProperty(t,"__esModule",{value:!0}),t.MAX_FILTER_LENGTH=t.MAX_NAME_LENGTH=t.MAX_AUDIENCE_LENGTH=t.SPLUNK_TIME_FORMAT=t.TOKEN_AUTH_PATH=t.TOKENS_COLLECTION_PATH=void 0,t.getDeleteTokenUrl=function(e,t){var n={id:t,output_mode:"json"};return(0,a.createRESTURL)(f+"/"+encodeURIComponent(e)+"?"+l.default.encode(n))},t.getChangeStatusURL=function(e,t,n){var s={id:t,status:n,output_mode:"json"};return(0,a.createRESTURL)(f+"/"+encodeURIComponent(e)+"?"+l.default.encode(s))},t.getToggleTokenAuthURL=function(e,t){var n={disabled:e,expiration:t,output_mode:"json"};return(0,a.createRESTURL)(c+"?"+l.default.encode(n))},t.getTokenAuthSettingsURL=function(){return(0,a.createRESTURL)(c+"?"+l.default.encode({output_mode:"json"}))},t.getStatusButtonLabel=function(e,t){if(e)return"enabled"===t?(0,s._)("Disabling..."):(0,s._)("Enabling...");return"enabled"===t?(0,s._)("Disable"):(0,s._)("Enable")},t.getPrimaryButtonLabel=function(e){return e?(0,s._)("Creating..."):(0,s._)("Create")},t.getDefaultButtonLabel=function(e){return e?(0,s._)("Close"):(0,s._)("Cancel")},t.canPerformAction=function(e,t,n){if(e.editAll||e.editOwn)return!0;if(e.editOwnListAll)return t===n;return!1},t.getTokenPermissions=function(e){return{read:!0,canEdit:e.indexOf("edit_tokens_all")>-1||e.indexOf("edit_tokens_own")>-1,editAll:e.indexOf("edit_tokens_all")>-1,editOwnListAll:e.indexOf("edit_tokens_own")>-1&&e.indexOf("list_tokens_all")>-1,editOwn:e.indexOf("edit_tokens_own")>-1&&!(e.indexOf("list_tokens_all")>-1),listAll:e.indexOf("list_tokens_all")>-1,listOwn:e.indexOf("list_tokens_own")>-1,canCreate:e.indexOf("edit_tokens_all")>-1||e.indexOf("edit_tokens_own")>-1,editSettings:e.indexOf("edit_tokens_settings")>-1}},t.formatTimestamp=m,t.formatLastUsedTime=function(e){return 0===e?(0,s._)("Unused"):m(e)},t.formatLastUsedIp=function(e){return""===e?(0,s._)("Unused"):e},t.formatTokenExp=function(e){return 0===e?(0,s._)("Never"):m(e)},t.isValidName=function(e){return!!e&&e.length<g},t.isValidAudience=function(e){return!!e&&e.length<h},t.canViewTokens=function(e){if(!e)return!1;return!!(e.editAll||e.editOwn||e.listAll||e.listOwn)},t.isValidTokenTime=function(e){if("-"===e.charAt(0)||/^\d+$/.test(e))return!1;return(0,u.isValidTime)(e)};var a=n(26),s=n(7),o=d(n(69)),l=d(n(35)),r=d(n("util/time")),i=n(28),u=n(105);function d(e){return e&&e.__esModule?e:{default:e}}var f=t.TOKENS_COLLECTION_PATH=(0,a.createRESTURL)("authorization/tokens"),c=t.TOKEN_AUTH_PATH=(0,a.createRESTURL)("admin/Token-auth/tokens_auth"),p=t.SPLUNK_TIME_FORMAT="ls z",h=t.MAX_AUDIENCE_LENGTH=256,g=t.MAX_NAME_LENGTH=1024;t.MAX_FILTER_LENGTH=250;function m(e){if(!e)return null;if(!o.default.getDefaultSplunkTimezone()||o.default.newSplunkTime({time:1e3*e}).splunkFormat(p).indexOf("undefined")>-1){var t=new Date(1e3*e);return(0,i.sprintf)((0,s._)("%(localTimestamp)s %(utcOffset)s UTC"),{localTimestamp:r.default.convertToLocalTime(e),utcOffset:r.default.getTimezoneString(t)})}return o.default.newSplunkTime({time:1e3*e}).splunkFormat(p)}},"views/tokens/components/DateTimePicker":function(e,t,n){"use strict";n(1),Object.defineProperty(t,"__esModule",{value:!0});var a=m(n(11)),s=m(n(13)),o=m(n(15)),l=m(n(16)),r=n(0),i=m(r),u=m(n(2)),d=m(n(69)),f=n(7),c=m(n(18)),p=m(n(23)),h=m(n(207)),g=m(n(39));function m(e){return e&&e.__esModule?e:{default:e}}var k=/^\d\d:\d\d$/,b=function(e){function t(e,n){(0,a.default)(this,t);var s=(0,o.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return s.getHelpText=function(){return"absolute"===s.state.selectType?(0,f._)("Time is in format HH:MM. Example: 15:45"):"relative"===s.state.selectType?(0,f._)("Examples: +10m,+20h,+30d"):""},s.formatDateTime=function(e,t){return t?k.test(t)?(0,d.default)(e+"T"+t).format():"bad time":(0,d.default)(e+"T00:00").format()},s.handleSelectTypeChange=function(e,t){var n=t.value;s.setState({selectType:n}),"absolute"===n?s.props.onChange(s.formatDateTime(s.state.date,s.state.time)):"relative"===n&&s.props.onChange(s.state.relTimeStr)},s.handleTimeTextChange=function(e,t){var n=t.value;s.setState({time:n}),s.props.onChange(s.formatDateTime(s.state.date,n))},s.handleDateChange=function(e,t){var n=t.value;s.setState({date:n}),s.props.onChange(s.formatDateTime(n,s.state.time))},s.handleRelTimeTextChange=function(e,t){var n=t.value;s.setState({relTimeStr:n}),s.props.onChange(n)},s.state={selectType:"relative",relTimeStr:"",date:(0,d.default)().format(h.default.momentFormat),time:"23:59"},s}return(0,l.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){return i.default.createElement("div",null,i.default.createElement(c.default,{label:this.props.label,controlsLayout:"none",help:this.getHelpText(),tooltip:this.props.tooltip,error:this.props.error,"data-test-name":"date-time-group"},i.default.createElement(g.default,{value:this.state.selectType,onChange:this.handleSelectTypeChange,disabled:this.props.disabled,error:this.props.error,style:{paddingBottom:"5px"},scrollContainer:this.props.scrollContainer},i.default.createElement(g.default.Option,{label:(0,f._)("Relative Time"),value:"relative"}),i.default.createElement(g.default.Option,{label:(0,f._)("Absolute Time"),value:"absolute"})),"absolute"===this.state.selectType&&i.default.createElement("div",{style:{minWidth:"205px"}},i.default.createElement(h.default,{value:this.state.date,onChange:this.handleDateChange,inline:!0,error:this.props.error,disabled:this.props.disabled}),i.default.createElement(p.default,{value:this.state.time,onChange:this.handleTimeTextChange,canClear:!0,inline:!0,style:{width:"90px"},error:this.props.error,disabled:this.props.disabled,"data-test-name":"abs-time-text"})),"relative"===this.state.selectType&&i.default.createElement(p.default,{value:this.state.relTimeStr,onChange:this.handleRelTimeTextChange,error:this.props.error,disabled:this.props.disabled,"data-test-name":"rel-time-text"})))}}]),t}(r.Component);b.propTypes={label:u.default.string.isRequired,onChange:u.default.func.isRequired,error:u.default.bool,disabled:u.default.bool,tooltip:u.default.string,scrollContainer:u.default.element},b.defaultProps={error:!1,disabled:!1,tooltip:"",scrollContainer:"window"},t.default=b,e.exports=t.default},"views/tokens/modals/CreateToken":function(e,t,n){"use strict";n(1),Object.defineProperty(t,"__esModule",{value:!0});var a=T(n(11)),s=T(n(13)),o=T(n(15)),l=T(n(16)),r=n(0),i=T(r),u=T(n(2)),d=n(7),f=n(28),c=T(n(14)),p=T(n(24)),h=T(n(20)),g=T(n(18)),m=T(n(23)),k=n("views/tokens/Utils"),b=T(n("views/tokens/components/DateTimePicker"));function T(e){return e&&e.__esModule?e:{default:e}}var _=(0,d._)("Token appears here after creation and is no longer accessible after you close this window."),E=function(e){function t(e,n){(0,a.default)(this,t);var s=(0,o.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return s.handleSave=function(){if(s.setState({isWorking:!0}),(0,k.isValidName)(s.state.name)&&(0,k.isValidAudience)(s.state.audience)&&(0,k.isValidTokenTime)(s.state.expiresOn)&&(0,k.isValidTokenTime)(s.state.notBefore)){var e={name:s.state.name,audience:s.state.audience,expires_on:s.state.expiresOn,not_before:s.state.notBefore,output_mode:"json"};s.props.callCreateToken(e).then((function(e){s.handleSuccess(e)})).catch((function(e){s.setState({isWorking:!1,errorMessage:e.message})}))}else s.setState({isWorking:!1,errorMessage:(0,d._)("Error in highlighted fields.")})},s.handleSuccess=function(e){e.entry[0]&&e.entry[0].content&&e.entry[0].content.token?(s.props.setShouldRefreshOnClose(),s.setState({errorMessage:"",isWorking:!1,tokenReady:!0,token:e.entry[0].content.token})):s.setState({errorMessage:(0,d._)("Unable to create token.")})},s.handleClose=function(){s.setState({isWorking:!1,errorMessage:""}),s.props.handleRequestClose()},s.handleNameTextChange=function(e,t){var n=t.value;s.setState({name:n})},s.handleAudienceTextChange=function(e,t){var n=t.value;s.setState({audience:n})},s.handleExpiresOnChange=function(e){s.setState({expiresOn:e})},s.handleNotBeforeChange=function(e){s.setState({notBefore:e})},s.handleMount=function(e){return s.setState({scrollContainer:e})},s.state={isWorking:!1,errorMessage:"",name:s.props.username,tokenReady:!1,audience:"",expiresOn:"",notBefore:"",scrollContainer:"window"},s}return(0,l.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){var e=this;return this.state.tokenReady&&this.cancelButton&&this.cancelButton.focus(),i.default.createElement(p.default,{onRequestClose:this.handleClose,open:this.props.open,style:{width:"500px"},"data-test-name":"create-modal"},i.default.createElement(p.default.Header,{title:(0,f.sprintf)((0,d._)("New %s"),this.props.objectNameSingular),onRequestClose:this.handleClose}),i.default.createElement(p.default.Body,{elementRef:this.handleMount},i.default.createElement(h.default,{type:"info"},(0,d._)("You can only create tokens for SAML users if you enable either attribute query requests or authentication extensions.")),this.state.errorMessage&&i.default.createElement(h.default,{type:"error"},this.state.errorMessage),i.default.createElement(g.default,{label:(0,d._)("User *"),tooltip:!this.props.permissions.editAll&&(0,d._)("You cannot edit tokens for other users."),help:this.state.errorMessage&&!(0,k.isValidName)(this.state.name)?(0,d._)("User is a required field and must contain fewer than 1024 characters."):(0,d._)("User who will receive this token."),"data-test-name":"name-group",error:this.state.errorMessage&&!(0,k.isValidName)(this.state.name)},i.default.createElement(m.default,{"data-test-name":"name-text",disabled:!this.props.permissions.editAll||this.state.tokenReady,canClear:!0,value:this.state.name,error:this.state.errorMessage&&!(0,k.isValidName)(this.state.name),onChange:this.handleNameTextChange,autoFocus:!0})),i.default.createElement(g.default,{label:(0,d._)("Audience *"),help:this.state.errorMessage&&!(0,k.isValidAudience)(this.state.audience)?(0,d._)("Audience is a required field and must contain fewer than 256 characters."):(0,d._)("Purpose of the token."),"data-test-name":"audience-group",error:this.state.errorMessage&&!(0,k.isValidAudience)(this.state.audience)},i.default.createElement(m.default,{"data-test-name":"audience-text",disabled:this.state.tokenReady,canClear:!0,value:this.state.audience,error:this.state.errorMessage&&!(0,k.isValidAudience)(this.state.audience),onChange:this.handleAudienceTextChange})),i.default.createElement(b.default,{label:(0,d._)("Expiration"),"data-test-name":"expires-on-group",value:this.state.expiresOn,onChange:this.handleExpiresOnChange,error:this.state.errorMessage&&!(0,k.isValidTokenTime)(this.state.expiresOn),disabled:this.state.tokenReady,scrollContainer:this.state.scrollContainer}),i.default.createElement(b.default,{label:(0,d._)("Not Before"),"data-test-name":"not-before-group",value:this.state.notBefore,onChange:this.handleNotBeforeChange,error:this.state.errorMessage&&!(0,k.isValidTokenTime)(this.state.notBefore),disabled:this.state.tokenReady,tooltip:(0,d._)("Token cannot be used before this time."),scrollContainer:this.state.scrollContainer}),i.default.createElement(g.default,{label:(0,d._)("Token"),help:_,"data-test-name":"token-group"},i.default.createElement(m.default,{"data-test-name":"token-text",value:this.state.token,multiline:!0,rowsMin:2,disabled:!this.state.tokenReady}))),i.default.createElement(p.default.Footer,null,i.default.createElement(c.default,{"data-test-name":"cancel-btn",onClick:this.handleClose,label:(0,k.getDefaultButtonLabel)(this.state.tokenReady),ref:function(t){e.cancelButton=t}}),!this.state.tokenReady&&i.default.createElement(c.default,{appearance:"primary","data-test-name":"save-btn",disabled:this.state.isWorking,onClick:this.handleSave,label:(0,k.getPrimaryButtonLabel)(this.state.isWorking)})))}}]),t}(r.Component);E.propTypes={open:u.default.bool.isRequired,objectNameSingular:u.default.string.isRequired,handleRequestClose:u.default.func.isRequired,setShouldRefreshOnClose:u.default.func.isRequired,callCreateToken:u.default.func.isRequired,username:u.default.string.isRequired,permissions:u.default.shape({editAll:u.default.bool}).isRequired},t.default=E,e.exports=t.default},"views/tokens/modals/DeleteToken":function(e,t,n){"use strict";n(1),Object.defineProperty(t,"__esModule",{value:!0});var a=p(n(10)),s=p(n(0)),o=p(n(2)),l=p(n(14)),r=p(n(24)),i=p(n(20)),u=p(n(46)),d=n(7),f=n(67),c=n(28);function p(e){return e&&e.__esModule?e:{default:e}}var h=function(e){return s.default.createElement("div",null,s.default.createElement(r.default,(0,a.default)({onRequestClose:e.handleClose,open:e.open,style:{minWidth:"500px"}},(0,f.createTestHook)("DeleteTokenModal")),s.default.createElement(r.default.Header,{title:(0,d._)("Delete Token"),onRequestClose:e.handleClose}),s.default.createElement(r.default.Body,null,e.errorMessage&&s.default.createElement(i.default,{type:"error"},e.errorMessage),s.default.createElement("div",{"data-test":"delete-modal-content"},(0,d._)("Are you sure you want to delete token")+" ",s.default.createElement(u.default,{content:e.tokenId,"data-test":"delete-modal-tooltip"},(0,c.sprintf)((0,d._)("'%(tokenId)s'"),{tokenId:(0,c.smartTrim)(e.tokenId,12)}))," "+(0,c.sprintf)((0,d._)("for user %(tokenOwner)s?"),{tokenOwner:e.tokenOwner}),s.default.createElement("div",{style:{paddingTop:"1px"},"data-test":"confirm-msg"},(0,d._)("You cannot undo this action.")))),s.default.createElement(r.default.Footer,null,s.default.createElement(l.default,{"data-test-name":"cancel-btn",onClick:e.handleClose,label:(0,d._)("Cancel"),autoFocus:!0}),s.default.createElement(l.default,{appearance:"primary","data-test-name":"delete-btn",disabled:e.isWorking,onClick:e.handleDelete,label:e.isWorking?(0,d._)("Deleting..."):(0,d._)("Delete")}))))};h.propTypes={open:o.default.bool,isWorking:o.default.bool,errorMessage:o.default.string,handleClose:o.default.func.isRequired,handleDelete:o.default.func.isRequired,tokenId:o.default.string.isRequired,tokenOwner:o.default.string.isRequired},h.defaultProps={open:!1,isWorking:!1,errorMessage:""},t.default=h,e.exports=t.default},"views/tokens/modals/TokenSettings":function(e,t,n){"use strict";n(1),Object.defineProperty(t,"__esModule",{value:!0});var a=T(n(11)),s=T(n(13)),o=T(n(15)),l=T(n(16)),r=n(0),i=T(r),u=T(n(2)),d=n(28),f=n(7),c=T(n(24)),p=T(n(14)),h=T(n(20)),g=T(n(18)),m=T(n(23)),k=T(n(32)),b=n("views/tokens/Utils");function T(e){return e&&e.__esModule?e:{default:e}}var _=function(e){function t(e,n){(0,a.default)(this,t);var s=(0,o.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return s.handleDefaultExpirationChange=function(e,t){var n=t.value;s.setState({defaultExpiration:n})},s.handleDisableClick=function(){s.setState({disabled:!s.state.disabled,defaultExpiration:"",errorMessage:""})},s.handleClose=function(){s.setState({isWorking:!1,errorMessage:""}),s.props.handleRequestClose()},s.handleSave=function(){s.setState({isWorking:!0}),s.state.defaultExpiration&&!(0,b.isValidTokenTime)(s.state.defaultExpiration)&&"never"!==s.state.defaultExpiration?s.setState({isWorking:!1,errorMessage:(0,f._)("Error in highlighted fields.")}):s.props.callToggleTokenAuth((0,b.getToggleTokenAuthURL)(s.state.disabled,s.state.defaultExpiration||s.props.defaultExpiration)).then((function(){s.setState({isWorking:!1,errorMessage:""}),s.props.setTokenSettings(s.state.disabled,s.state.defaultExpiration||s.props.defaultExpiration),s.handleClose()})).catch((function(e){s.setState({isWorking:!1,errorMessage:e.message})}))},s.state={defaultExpiration:s.props.defaultExpiration,disabled:!s.props.tokenAuthEnabled},s}return(0,l.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){return i.default.createElement(c.default,{onRequestClose:this.handleClose,open:this.props.open,style:{width:"500px"},"data-test-name":"token-settings-modal"},i.default.createElement(c.default.Header,{title:(0,d.sprintf)((0,f._)("%s Settings"),this.props.objectNameSingular),onRequestClose:this.handleClose}),i.default.createElement(c.default.Body,null,this.state.errorMessage&&i.default.createElement(h.default,{type:"error"},this.state.errorMessage),this.state.disabled&&i.default.createElement(h.default,{type:"warning"},(0,f._)("If Token Authentication is off, all tokens will be disabled, regardless of their individual status.")),i.default.createElement(g.default,{label:(0,f._)("Token Authentication"),"data-test-name":"token-auth-group"},i.default.createElement(k.default,{value:"disabled",onClick:this.handleDisableClick,selected:!this.state.disabled,appearance:"toggle","data-test-name":"token-auth-switch"},this.state.disabled?(0,f._)("Disabled"):(0,f._)("Enabled"))),i.default.createElement(g.default,{label:(0,f._)("Default Expiration"),"data-test-name":"expiration-group",error:!(!this.state.errorMessage||this.state.disabled),help:(0,f._)('The default expiration time for tokens you create where you do not set an expiration individually. Can be either a relative time (Example: +10m, +20h, +30d) or the word "never" for no default expiration. Cannot be greater than +18y.')},i.default.createElement(m.default,{"data-test-name":"expiration-text",canClear:!0,value:this.state.defaultExpiration,error:!(!this.state.errorMessage||this.state.disabled),onChange:this.handleDefaultExpirationChange,placeholder:this.props.defaultExpiration,disabled:this.state.disabled}))),i.default.createElement(c.default.Footer,null,i.default.createElement(p.default,{"data-test-name":"cancel-btn",onClick:this.handleClose,label:(0,f._)("Cancel"),autoFocus:!0}),i.default.createElement(p.default,{appearance:"primary","data-test-name":"save-btn",disabled:this.state.isWorking,onClick:this.handleSave,label:(0,f._)("Save")})))}}]),t}(r.Component);_.propTypes={objectNameSingular:u.default.string.isRequired,handleRequestClose:u.default.func.isRequired,open:u.default.bool.isRequired,setTokenSettings:u.default.func.isRequired,callToggleTokenAuth:u.default.func.isRequired,tokenAuthEnabled:u.default.bool.isRequired,defaultExpiration:u.default.string.isRequired},t.default=_,e.exports=t.default},"views/tokens/modals/TokenStatus":function(e,t,n){"use strict";n(1),Object.defineProperty(t,"__esModule",{value:!0});var a=p(n(10)),s=p(n(0)),o=p(n(2)),l=n(7),r=p(n(14)),i=p(n(20)),u=p(n(24)),d=p(n(46)),f=n(67),c=n(28);function p(e){return e&&e.__esModule?e:{default:e}}var h=function(e){return s.default.createElement(u.default,(0,a.default)({onRequestClose:e.handleClose,open:e.open,style:{minWidth:"500px"}},(0,f.createTestHook)("TokenStatusModal")),s.default.createElement(u.default.Header,{title:e.modalTitle,onRequestClose:e.handleClose}),s.default.createElement(u.default.Body,null,e.errorMessage&&s.default.createElement(i.default,{type:"error"},e.errorMessage),s.default.createElement("div",{"data-test":"status-modal-content"},(0,c.sprintf)((0,l._)("Are you sure you want to %(enableOrDisable)s token")+" ",{enableOrDisable:e.enableOrDisable}),s.default.createElement(d.default,{content:e.tokenId,"data-test":"status-modal-tooltip"},(0,c.sprintf)((0,l._)("'%(tokenId)s'"),{tokenId:(0,c.smartTrim)(e.tokenId,12)}))," "+(0,c.sprintf)((0,l._)("for user %(tokenOwner)s?"),{tokenOwner:e.tokenOwner}))),s.default.createElement(u.default.Footer,null,s.default.createElement(r.default,{"data-test-name":"cancel-btn",onClick:e.handleClose,label:(0,l._)("Cancel"),autoFocus:!0}),s.default.createElement(r.default,{appearance:"primary","data-test-name":"change-status-btn",disabled:e.isWorking,onClick:e.handleChangeStatus,label:e.changeStatusButtonLabel})))};h.propTypes={open:o.default.bool,isWorking:o.default.bool,errorMessage:o.default.string,changeStatusButtonLabel:o.default.string.isRequired,modalTitle:o.default.string.isRequired,handleClose:o.default.func.isRequired,handleChangeStatus:o.default.func.isRequired,tokenId:o.default.string.isRequired,tokenOwner:o.default.string.isRequired,enableOrDisable:o.default.string.isRequired},h.defaultProps={open:!1,isWorking:!1,errorMessage:""},t.default=h,e.exports=t.default},"views/tokens/table/columns/TokenActions":function(e,t,n){"use strict";n(1),Object.defineProperty(t,"__esModule",{value:!0});var a=m(n(11)),s=m(n(13)),o=m(n(15)),l=m(n(16)),r=n(0),i=m(r),u=m(n(2)),d=n(7),f=n(28),c=m(n(22)),p=m(n("views/tokens/modals/DeleteToken")),h=m(n("views/tokens/modals/TokenStatus")),g=n("views/tokens/Utils");function m(e){return e&&e.__esModule?e:{default:e}}var k=function(e){function t(e,n){(0,a.default)(this,t);var s=(0,o.default)(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return s.openDeleteModal=function(){s.setState({deleteOpen:!0})},s.handleDelete=function(){s.setState({isWorking:!0}),s.props.callDeleteToken((0,g.getDeleteTokenUrl)(s.state.tokenOwner,s.state.title)).then((function(){s.props.handleDeleteChange(1),s.props.handleRefreshListing()}),(function(e){return s.setState({isWorking:!1,errorMessage:e.message})}))},s.handleDeleteClose=function(){s.setState({deleteOpen:!1,errorMessage:""})},s.openStatusModal=function(){s.setState({statusOpen:!0})},s.handleChangeStatus=function(){s.setState({isWorking:!0}),s.props.callChangeStatus((0,g.getChangeStatusURL)(s.props.object.content.claims.sub,s.props.object.name,s.props.isEnabled(s.props.object)?"disabled":"enabled")).then((function(){s.props.handleRefreshListing()}),(function(e){return s.setState({isWorking:!1,errorMessage:e.message})}))},s.handleStatusClose=function(){s.setState({isWorking:!1,statusOpen:!1,errorMessage:""})},s.state={deleteOpen:!1,isWorking:!1,errorMessage:"",title:s.props.object[s.props.nameAttribute]||"",tokenOwner:s.props.object.content.claims.sub,statusOpen:!1},s}return(0,l.default)(t,e),(0,s.default)(t,[{key:"render",value:function(){return(0,g.canPerformAction)(this.props.permissions,this.props.object.content.claims.sub,this.props.username)&&i.default.createElement("div",{style:{display:"flex",flexDirection:"row"}},i.default.createElement(c.default,{"data-test-name":"delete",key:"delete",onClick:this.openDeleteModal,style:{padding:"4px 5px"}},(0,d._)("Delete ")),i.default.createElement(p.default,{open:this.state.deleteOpen,isWorking:this.state.isWorking,errorMessage:this.state.errorMessage,handleDelete:this.handleDelete,handleClose:this.handleDeleteClose,tokenId:this.state.title,tokenOwner:this.props.object.content.claims.sub}),i.default.createElement(c.default,{"data-test-name":"changeStatus",key:"changeStatus",onClick:this.openStatusModal,style:{padding:"4px 5px"}},this.props.isEnabled(this.props.object)?(0,d._)("Disable"):(0,d._)("Enable")),i.default.createElement(h.default,{open:this.state.statusOpen,isWorking:this.state.isWorking,errorMessage:this.state.errorMessage,modalTitle:(0,f.sprintf)((0,d._)("%(enableOrDisable)s %(tokenSingular)s"),{enableOrDisable:this.props.isEnabled(this.props.object)?(0,d._)("Disable"):(0,d._)("Enable"),tokenSingular:this.props.objectNameSingular}),handleClose:this.handleStatusClose,changeStatusButtonLabel:(0,g.getStatusButtonLabel)(this.state.isWorking,this.props.object.content.status),handleChangeStatus:this.handleChangeStatus,tooltipContent:this.state.title,tokenId:this.state.title,tokenOwner:this.props.object.content.claims.sub,enableOrDisable:this.props.isEnabled(this.props.object)?(0,d._)("disable"):(0,d._)("enable")}))}}]),t}(r.Component);k.propTypes={object:u.default.shape({name:u.default.string.isRequired,content:u.default.shape({claims:u.default.shape({sub:u.default.string.isRequired}),status:u.default.string.isRequired})}).isRequired,nameAttribute:u.default.string.isRequired,handleRefreshListing:u.default.func.isRequired,handleDeleteChange:u.default.func.isRequired,callDeleteToken:u.default.func.isRequired,callChangeStatus:u.default.func.isRequired,permissions:u.default.shape({editAll:u.default.bool.isRequired,editOwn:u.default.bool.isRequired,editOwnListAll:u.default.bool.isRequired}).isRequired,username:u.default.string.isRequired,objectNameSingular:u.default.string.isRequired,isEnabled:u.default.func.isRequired},k.defaultProps={nameAttribute:"name"},t.default=k,e.exports=t.default}});